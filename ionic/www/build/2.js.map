{"version":3,"sources":["../../src/pages/device/device.module.ts","../../src/pages/device/device.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { DevicePage } from './device';\nimport { SuperTabsModule } from 'ionic2-super-tabs';\n\n@NgModule({\n  declarations: [\n    DevicePage,\n  ],\n  imports: [\n    SuperTabsModule,\n    IonicPageModule.forChild(DevicePage),\n  ],\n})\nexport class HomePageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/device/device.module.ts","import { AuthProvider } from './../../providers/auth/auth';\nimport { DeviceConsolePage } from './../device-console/device-console';\nimport { DeviceInfoPage } from './../device-info/device-info';\nimport { MqttProvider } from './../../providers/mqtt/mqtt';\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Events } from 'ionic-angular';\nimport { Subscription } from 'rxjs/Subscription';\n\n@IonicPage(\n  {\n    name: 'DevicePage',\n    segment: 'device/:id'\n  }\n)\n@Component({\n  selector: 'page-device',\n  templateUrl: 'device.html',\n})\nexport class DevicePage {\n\n  ctrlID: string = '';\n  tabs = [];\n  topic: string;\n  isMqttInit: boolean = false;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private mqtt: MqttProvider,\n    private events: Events,\n    private auth: AuthProvider\n  ) {\n\n  }\n\n  ionViewCanEnter(): Promise<boolean> {\n    return this.auth.checkAuthentication()\n  }\n\n  ionViewWillLeave() {\n    // stop all subscription\n    this.events.publish('subscription:stop');\n    if (this.isMqttInit){\n      this.mqtt.unsubscribeTopic(this.topic);\n      this.mqtt.unregisterCallback(this.ctrlID);\n    }\n  }\n\n  ionViewDidLoad() {\n    if (this.navParams.get('id')) {\n      this.ctrlID = this.navParams.get('id');\n      this.tabs = [\n        {\n          page: DeviceInfoPage,\n          params: {\n            id: this.ctrlID\n          },\n          title: 'Info',\n          id: 'Info'\n        }, {\n          page: DeviceConsolePage,\n          params: {\n            id: this.ctrlID\n          },\n          title: 'Console',\n          id: 'Console'\n        }\n      ]\n\n      console.log(this.tabs)\n      // register callback\n      this.mqtt.ready().then(() => {\n        this.isMqttInit = true;\n        this.topic = this.ctrlID + '/#';\n        this.mqtt.subscribeTopic(this.topic, 1);\n        this.mqtt.registerCallback(this.ctrlID, this.callback.bind(this))\n      })\n    }\n  }\n\n  callback(message) {\n    //console.log(message)\n    this.events.publish('subscription:mqtt', message)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/device/device.ts"],"sourceRoot":""}